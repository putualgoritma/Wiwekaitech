{% extends "base.html" %}
{% block title %}Edit Project - Wiwekaitech Admin{% endblock %}
{% block content %}
<div class="page-header">
    <h2>Edit Project</h2>
</div>
<form id="projectForm" class="content-form">
    <div class="form-row">
        <div class="form-group">
            <label for="title_en">Title (English):</label>
            <input type="text" id="title_en" name="title_en" value="{{ project.title_en }}" required>
        </div>
        <div class="form-group">
            <label for="title_id">Title (Indonesian):</label>
            <input type="text" id="title_id" name="title_id" value="{{ project.title_id }}" required>
        </div>
    </div>
    <div class="form-group">
        <label for="slug">Slug:</label>
        <input type="text" id="slug" name="slug" value="{{ project.slug }}" required>
    </div>
    <div class="form-row">
        <div class="form-group">
            <label for="summary_en">Summary (English):</label>
            <textarea id="summary_en" name="summary_en" required>{{ project.summary_en }}</textarea>
        </div>
        <div class="form-group">
            <label for="summary_id">Summary (Indonesian):</label>
            <textarea id="summary_id" name="summary_id" required>{{ project.summary_id }}</textarea>
        </div>
    </div>
    <div class="form-row">
        <div class="form-group">
            <label for="description_en">Description (English):</label>
            <textarea id="description_en" name="description_en" required>{{ project.description_en }}</textarea>
        </div>
        <div class="form-group">
            <label for="description_id">Description (Indonesian):</label>
            <textarea id="description_id" name="description_id" required>{{ project.description_id }}</textarea>
        </div>
    </div>
    <div class="form-row">
        <div class="form-group">
            <label for="client_name">Client Name:</label>
            <input type="text" id="client_name" name="client_name" value="{{ project.client_name or '' }}">
        </div>
        <div class="form-group">
            <label for="industry">Industry:</label>
            <input type="text" id="industry" name="industry" value="{{ project.industry or '' }}">
        </div>
    </div>
    <div class="form-actions">
        <button type="submit" class="btn btn-primary">Update Project</button>
        <a href="/admin/projects" class="btn btn-secondary">Cancel</a>
    </div>
    <div id="message" class="message" style="display: none;"></div>
</form>
<script>
const projectId = {{ project.id }};
document.getElementById('projectForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const payload = {
        title_en: document.getElementById('title_en').value,
        title_id: document.getElementById('title_id').value,
        slug: document.getElementById('slug').value,
        summary_en: document.getElementById('summary_en').value,
        summary_id: document.getElementById('summary_id').value,
        description_en: document.getElementById('description_en').value,
        description_id: document.getElementById('description_id').value,
        client_name: document.getElementById('client_name').value || null,
        industry: document.getElementById('industry').value || null,
        is_active: true,
        is_featured: false,
    };
    try {
        const response = await fetch(`/api/v1/admin/projects/${projectId}`, {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        });
        if (response.ok) {
            alert('Project updated successfully');
            window.location.href = '/admin/projects';
        }
    } catch (error) {
        alert('Error: ' + error.message);
    }
});
</script>
{% endblock %}
