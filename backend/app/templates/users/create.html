{% extends "base.html" %}
{% block title %}Create User - Wiwekaitech Admin{% endblock %}
{% block content %}
<div class="page-header"><h2>Create User</h2></div>
<form id="form" class="content-form">
    <div class="form-group">
        <label>Username: <input type="text" id="username" required></label>
    </div>
    <div class="form-group">
        <label>Email: <input type="email" id="email" required></label>
    </div>
    <div class="form-group">
        <label>Password: <input type="password" id="password" required></label>
    </div>
    <div class="form-group">
        <label>Role: 
            <select id="role">
                <option value="viewer">Viewer</option>
                <option value="editor">Editor</option>
                <option value="admin">Admin</option>
            </select>
        </label>
    </div>
    <div class="form-actions">
        <button type="submit" class="btn btn-primary">Create</button>
        <a href="/admin/users" class="btn btn-secondary">Cancel</a>
    </div>
</form>
<script>
document.getElementById('form').addEventListener('submit', async (e) => {
    e.preventDefault();
    const payload = {
        username: document.getElementById('username').value,
        email: document.getElementById('email').value,
        password: document.getElementById('password').value,
        role: document.getElementById('role').value,
        is_active: true
    };
    try {
        const response = await fetch('/api/v1/admin/users', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        });
        if (response.ok) {
            window.location.href = '/admin/users';
        } else {
            alert('Error creating user');
        }
    } catch (error) {
        alert('Error: ' + error.message);
    }
});
</script>
{% endblock %}
